 <%            Dim conn, rs, SQL, arama, toplamTutar, oncekiTarih            ' Veritabanı bağlantısı            Set conn = Server.CreateObject("ADODB.Connection")            conn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Server.MapPath("/db/harc.mdb")            ' Arama terimini al            arama = Request.QueryString("arama")                        ' SQL sorgusunu oluştur            SQL = "SELECT * FROM HARC"            If arama <> "" Then                SQL = SQL & " WHERE musteri LIKE '%" & arama & "%' OR modelno LIKE '%" & arama & "%'"            End If            SQL = SQL & " ORDER BY tarih DESC, id DESC"            ' Kayıt kümesini oluştur            Set rs = conn.Execute(SQL)            ' Değişkenleri sıfırla            toplamTutar = 0            oncekiTarih = ""            ' Kayıtları listele            If Not rs.EOF Then                Do While Not rs.EOF                    ' Tarih değiştiyse ayırıcı satır ekle                    If rs("tarih") <> oncekiTarih And oncekiTarih <> "" Then                        %>                        <tr class="separatorRow">                            <td colspan="7"><b><%=oncekiTarih%> Toplam Tutar:</b></td>                            <td><b><%=toplamTutar%></b></td>                            <td colspan="1"></td>                        </tr>                        <%                        toplamTutar = 0 ' Toplamı sıfırla                    End If                    ' Satır sınıfını belirleme (kontrol alanına göre)                    Dim rowClass                    If rs("kontrol") = 1 Then                        rowClass = "checkedRow"                    Else                        rowClass = ""                    End If                    %>                    <tr class="<%=rowClass%>">                        <td><%=rs("id")%></td>                        <td><%=rs("tarih")%></td>                        <td><%=rs("firma")%></td>                        <td><%=rs("model")%></td>                        <td><%=rs("modelno")%></td>                        <td><%=rs("fiyat")%></td>                        <td><%=rs("musteri")%></td>                        <td><%=rs("aciklama")%></td>                                           </tr>                    <%                    ' Toplamı güncelle                    toplamTutar = toplamTutar + CDbl(rs("fiyat"))                    ' Önceki tarihi güncelle                    oncekiTarih = rs("tarih")                    rs.MoveNext                Loop                ' Son tarih için ayırıcı satır ekle                %>                <tr class="separatorRow">                    <td colspan="7"><b><%=oncekiTarih%> Toplam Tutar:</b></td>                    <td><b><%=toplamTutar%></b></td>                    <td colspan="1"></td>                </tr>                <%            Else                Response.Write("<tr><td colspan='9'>Kayıt bulunamadı.</td></tr>")            End If            ' Bağlantıyı kapat            rs.Close            Set rs = Nothing            conn.Close            Set conn = Nothing        %>